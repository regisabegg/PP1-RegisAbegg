@model PP1.CONTRATO.WEB.Models.Cliente.ClienteVM
@using PP1.CONTRATO.WEB.Util

@{
    ViewBag.Title = "Cadastrar usuario";
    Layout = "~/Views/Shared/_Layout.cshtml";

    ViewBag.action = ViewContext.Controller.ValueProvider.GetValue("action").RawValue.ToString().ToLower();
    ViewBag.readOnly = false;
}

<nav class="breadcrumb sl-breadcrumb">
    <a class="breadcrumb-item" href="@Url.Action("Index","Home")">Painel</a>
    <a class="breadcrumb-item" href="@Url.Action("Index","Cliente")">Cliente</a>
    <span class="breadcrumb-item active">Cadastrar</span>
</nav>

<div class="sl-pagebody">
    <div class="card pd-20 pd-sm-40">


        @using (Html.BeginForm("Create", "Cliente", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <h2>Criar cliente</h2>
                <div class="form-horizontal">
                    @Html.RenderFlashMessage()
                    @Html.CustomValidationSummary(true, true, "Ocorreram alguns erros, por favor verifique!!", new { @class = "alert alert-danger", role = "alert" })

                    @Html.Partial("Form", Model)

                    <div class="form-group" style="float:right; margin-bottom:2px">
                        <label class="control-label col-xs-12">AÇÕES</label><div class="col-xs-12">
                            <a class="btn btn-secondary" style="min-width:120px; margin-bottom:5px" href="@Url.Action("Index")" title="Voltar"><span class="glyphicon glyphicon-arrow-left"></span> Voltar</a>
                            <a class="btn btn-warning" style="min-width:120px; margin-bottom:5px" href="@Url.Action("Create")" title="Limpar o formulário"><i class="glyphicon glyphicon-refresh"></i> Limpar</a>
                            <button class="btn btn-success" style="min-width:120px; margin-bottom:5px" data-loading-text="Aguarde..." title="Salvar registro" type="submit" value="create"><i class="fa fa-save"></i> Salvar</button>
                        </div>
                    </div>
                </div>
            </div>


        }
    </div>
</div><!-- sl-pagebody -->



@section scripts {

    @Scripts.Render("~/Scripts/Cliente/Create.js?")
    <script src="~/Scripts/Common.js"></script>
    <script>
        function getCep() {
            const cep = $("#nrCEP").val();
            const bairro = $("#nmBairro").val();
            const logradouro = $("#nmLogradouro").val();
            const ibge = $("#nrIBGE").val();

            if (cep != "") {
                fetch("https://viacep.com.br/ws/" + cep + "/json/")
                    .then(
                        function (response) {
                            if (response.status !== 200) {
                                //console.log(response.status);

                                return;
                            }

                            response.json().then(function (data) {
                                $("#nrCEP").val(data.cep);
                                $("#nmCidade").val(data.localidade);
                                $("#nmBairro").val(data.bairro);
                                $("#nmLogradouro").val(data.logradouro);
                                $("#nrIBGE").val(data.ibge);

                                if (data.logradouro == "") {
                                    $("#nmLogradouro").focus();
                                }
                                else {
                                    $("#nrNumero").focus();

                                }
                            });

                        }
                    )
                    .catch(function (err) {
                        console.log('Erro: ', err);
                    });
            } else {
                alert("Informe o número");
            }
        }
    </script>
    <script>
        $(function () {
            'use strict';
            $('.select2').select2({
                minimumResultsForSearch: Infinity
            });

            $('#selectForm').parsley();
        })
    </script>
}
